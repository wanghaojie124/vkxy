webpackJsonp([2],{T1KA:function(t,e){},dgC9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={name:"information",data:function(){return{token:"",fullHeight:0,collegeList:this.common.collegeList(),college:"",loading:!0,informationList:[],informationCurrentPage:1,informationPageSize:20,informationTotal:0,addInformationDialog:!1,addInformationSureLoad:!1,noticeList:[{value:0,label:"不显示"},{value:1,label:"显示"}],informationTitle:"",informationIntro:"",informationContent:"",informationWeight:"",informationCollege:"西南交通大学",informationOnIndex:0,informationType:"",informationLink:"",informationImage:"",editInformationDialog:!1,editInformationSureLoad:!1,editInformationId:"",editInformationTitle:"",editInformationIntro:"",editInformationContent:"",editInformationWeight:"",editInformationCollege:"西南交通大学",editInformationOnIndex:"",editInformationType:"",editInformationLink:"",editInformationImage:""}},mounted:function(){var t=this;this.fullHeight=document.documentElement.clientHeight-this.$refs.headerView.offsetHeight-this.$refs.headSearchView.offsetHeight-220,window.onresize=function(){t.fullHeight=document.documentElement.clientHeight-t.$refs.headerView.offsetHeight-t.$refs.headSearchView.offsetHeight-220},localStorage.getItem("islogin")?this.getInformationList():this.common.loginOut(this)},methods:{getInformationList:function(){var t=this;this.loading=!0,this.common.requestDataParams("/vk/articlelist","GET",{college:t.college,page:t.informationCurrentPage,limit:t.informationPageSize}).then(function(e){t.informationList=e.data.data,t.informationTotal=e.data.total,t.loading=!1}).catch(function(t){console.log(t)})},addInformationSure:function(){var t=this;if(this.checkAddInformation()){this.addInformationSureLoad=!0;var e=this.$refs.clearImageFile.files[0];this.common.requestDataFile("/vk/addarticle","POST",{title:t.informationTitle,intro:t.informationIntro,content:t.informationContent,weight:t.informationWeight,college:t.informationCollege,on_index:t.informationOnIndex,type:t.informationType,link:t.informationLink,image:e}).then(function(e){t.addInformationDialog=!1,t.addInformationSureLoad=!1,t.informationTitle="",t.informationIntro="",t.informationContent="",t.informationWeight="",t.informationCollege="西南交通大学",t.informationOnIndex=0,t.informationType="",t.informationLink="",t.informationImage="",t.$refs.clearImageFile.value="",t.getInformationList()}).catch(function(t){console.log(t)})}},checkAddInformation:function(){var t=this.informationTitle,e=this.informationWeight,i=this.informationType,n=this.informationLink,o=this.$refs.clearImageFile.value;return""===t||null===t||void 0===t?(this.$message.error("标题不能为空"),!1):""===e||null===e||void 0===e?(this.$message.error("权重不能为空"),!1):""===i||null===i||void 0===i?(this.$message.error("类型不能为空"),!1):""===n||null===n||void 0===n?(this.$message.error("链接不能为空"),!1):""!==o&&null!==o&&void 0!==o||(this.$message.error("图片不能为空"),!1)},selectImage:function(t){var e=t.target.files[0];e?this.informationImage=window.URL.createObjectURL(e):(this.$refs.clearImageFile.value="",this.informationImage="")},editInformation:function(t){this.editInformationDialog=!0,this.editInformationId=t.id,this.editInformationTitle=t.title,this.editInformationIntro=t.intro,this.editInformationContent=t.content,this.editInformationWeight=t.weight,this.editInformationCollege=t.college,this.editInformationOnIndex=t.on_index,this.editInformationType=t.type,this.editInformationLink=t.link,this.editInformationImage=t.image},editInformationSure:function(){var t=this;if(this.checkEditInformation()){this.editInformationSureLoad=!0;var e=this.$refs.clearImageFile1.files[0];this.common.requestDataFile("/vk/updatearticles","POST",{id:t.editInformationId,title:t.editInformationTitle,intro:t.editInformationIntro,content:t.editInformationContent,weight:t.editInformationWeight,college:t.editInformationCollege,on_index:t.editInformationOnIndex,type:t.editInformationType,link:t.editInformationLink,image:e||"",status:1}).then(function(e){t.editInformationDialog=!1,t.editInformationSureLoad=!1,t.$refs.clearImageFile1.value="",t.getInformationList()}).catch(function(t){console.log(t)})}},checkEditInformation:function(){var t=this.editInformationTitle,e=this.editInformationWeight,i=this.editInformationType,n=this.editInformationLink;return""===t||null===t||void 0===t?(this.$message.error("标题不能为空"),!1):""===e||null===e||void 0===e?(this.$message.error("权重不能为空"),!1):""===i||null===i||void 0===i?(this.$message.error("类型不能为空"),!1):""!==n&&null!==n&&void 0!==n||(this.$message.error("链接不能为空"),!1)},selectImage1:function(t){var e=t.target.files[0];e?this.editInformationImage=window.URL.createObjectURL(e):(this.$refs.clearImageFile1.value="",this.editInformationImage="")},deleteInformation:function(t){var e=this;this.$confirm("是否删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.common.requestDataFile("/vk/updatearticles","POST",{id:t.id,status:0}).then(function(t){e.$message.success("删除成功"),e.getInformationList()}).catch(function(t){console.log(t)})}).catch(function(t){console.log(t)})},informationCurrentChange:function(t){this.informationCurrentPage=t,this.getInformationList()},refresh:function(){this.getInformationList()}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"information"},[i("div",{ref:"headerView"},[i("el-row",[i("el-col",{attrs:{span:24}},[t._v("\n                资讯列表\n                "),i("div",{staticClass:"el-header-right"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.addInformationDialog=!0}}},[t._v("新增资讯")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-refresh"},on:{click:function(e){return t.refresh()}}})],1)])],1)],1),t._v(" "),i("div",{ref:"headSearchView"},[i("el-row",{staticClass:"el-top"},[i("el-col",{attrs:{span:24}},[i("el-select",{attrs:{clearable:"",size:"small",placeholder:"学校"},model:{value:t.college,callback:function(e){t.college=e},expression:"college"}},t._l(t.collegeList,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.refresh()}}},[t._v("查询")])],1)],1)],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"el-top",attrs:{data:t.informationList,height:t.fullHeight||null,size:"small"}},[i("el-table-column",{attrs:{prop:"title",label:"标题"}}),t._v(" "),i("el-table-column",{attrs:{prop:"intro",label:"简介"}}),t._v(" "),i("el-table-column",{attrs:{prop:"weight",label:"权重"}}),t._v(" "),i("el-table-column",{attrs:{prop:"on_index",label:"首页显示"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.on_index?i("div",{staticClass:"red-text"},[t._v("否")]):i("div",{staticClass:"green-text"},[t._v("是")])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"type",label:"类型"}}),t._v(" "),i("el-table-column",{attrs:{prop:"link",label:"链接"}}),t._v(" "),i("el-table-column",{attrs:{label:"图片",width:"200"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("img",{staticClass:"information-img",attrs:{src:t.row.image}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"content",label:"内容"}}),t._v(" "),i("el-table-column",{attrs:{prop:"college",label:"学校"}}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){return t.editInformation(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.deleteInformation(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("el-row",[i("el-col",{staticClass:"page-block",attrs:{md:24}},[i("el-pagination",{attrs:{background:!0,"page-size":t.informationPageSize,total:t.informationTotal,"current-page":t.informationCurrentPage,layout:"total, prev, pager, next, jumper"},on:{"current-change":t.informationCurrentChange}})],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"新增资讯",visible:t.addInformationDialog,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(e){t.addInformationDialog=e}}},[i("el-form",{nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"标题 *",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.informationTitle,callback:function(e){t.informationTitle=e},expression:"informationTitle"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"简介",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.informationIntro,callback:function(e){t.informationIntro=e},expression:"informationIntro"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"内容",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.informationContent,callback:function(e){t.informationContent=e},expression:"informationContent"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"权重 *",size:"medium","label-width":"100px"}},[i("el-input",{attrs:{type:"number",placeholder:"数值越大，在首页显示越靠前"},model:{value:t.informationWeight,callback:function(e){t.informationWeight=e},expression:"informationWeight"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"学校",size:"medium","label-width":"100px"}},[i("el-select",{attrs:{size:"medium"},model:{value:t.informationCollege,callback:function(e){t.informationCollege=e},expression:"informationCollege"}},t._l(t.collegeList,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"公告栏显示",size:"medium","label-width":"100px"}},[i("el-select",{attrs:{size:"medium"},model:{value:t.informationOnIndex,callback:function(e){t.informationOnIndex=e},expression:"informationOnIndex"}},t._l(t.noticeList,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"类型 *",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.informationType,callback:function(e){t.informationType=e},expression:"informationType"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"链接 *",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.informationLink,callback:function(e){t.informationLink=e},expression:"informationLink"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"图片 *",size:"medium","label-width":"100px"}},[i("div",{staticClass:"file-creation"},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选择文章图片")]),t._v(" "),i("input",{ref:"clearImageFile",attrs:{type:"file",accept:"image/*"},on:{change:function(e){return t.selectImage(e)}}})],1),t._v(" "),i("div",{staticClass:"el-top"},[i("img",{staticClass:"file-image",attrs:{src:t.informationImage}})])])],1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.addInformationDialog=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary",loading:t.addInformationSureLoad},on:{click:function(e){return t.addInformationSure()}}},[t._v("确 定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"编辑资讯",visible:t.editInformationDialog,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(e){t.editInformationDialog=e}}},[i("el-form",{nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"标题 *",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.editInformationTitle,callback:function(e){t.editInformationTitle=e},expression:"editInformationTitle"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"简介",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.editInformationIntro,callback:function(e){t.editInformationIntro=e},expression:"editInformationIntro"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"内容",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.editInformationContent,callback:function(e){t.editInformationContent=e},expression:"editInformationContent"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"权重 *",size:"medium","label-width":"100px"}},[i("el-input",{attrs:{type:"number",placeholder:"数值越大，在首页显示越靠前"},model:{value:t.editInformationWeight,callback:function(e){t.editInformationWeight=e},expression:"editInformationWeight"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"学校",size:"medium","label-width":"100px"}},[i("el-select",{attrs:{size:"medium"},model:{value:t.editInformationCollege,callback:function(e){t.editInformationCollege=e},expression:"editInformationCollege"}},t._l(t.collegeList,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"公告栏显示",size:"medium","label-width":"100px"}},[i("el-select",{attrs:{size:"medium"},model:{value:t.editInformationOnIndex,callback:function(e){t.editInformationOnIndex=e},expression:"editInformationOnIndex"}},t._l(t.noticeList,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"类型 *",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.editInformationType,callback:function(e){t.editInformationType=e},expression:"editInformationType"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"链接 *",size:"medium","label-width":"100px"}},[i("el-input",{model:{value:t.editInformationLink,callback:function(e){t.editInformationLink=e},expression:"editInformationLink"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"图片 *",size:"medium","label-width":"100px"}},[i("div",{staticClass:"file-creation"},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选择文章图片")]),t._v(" "),i("input",{ref:"clearImageFile1",attrs:{type:"file",accept:"image/*"},on:{change:function(e){return t.selectImage1(e)}}})],1),t._v(" "),i("div",{staticClass:"el-top"},[i("img",{staticClass:"file-image",attrs:{src:t.editInformationImage}})])])],1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.editInformationDialog=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary",loading:t.editInformationSureLoad},on:{click:function(e){return t.editInformationSure()}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var a=i("VU/8")(n,o,!1,function(t){i("T1KA")},"data-v-a55b8d06",null);e.default=a.exports}});
//# sourceMappingURL=2.fe83af9878e31461bd2c.js.map