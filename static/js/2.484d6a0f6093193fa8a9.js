webpackJsonp([2],{eT3b:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a={name:"banner",data:function(){return{token:"",fullHeight:0,collegeList:[{value:"西南交通大学",label:"西南交通大学"}],college:"",loading:!0,bannerList:[],bannerCurrentPage:1,bannerPageSize:20,bannerTotal:0,addBannerDialog:!1,addBannerSureLoad:!1,specialList:[{value:0,label:"不显示"},{value:1,label:"显示"}],bannerTitle:"",bannerWeight:"",bannerCollege:"西南交通大学",bannerSpecial:0,bannerMini:"",bannerLink:"",bannerPrice:"",bannerBargainPrice:"",bannerImage:"",editBannerDialog:!1,editBannerSureLoad:!1,editBannerId:"",editBannerTitle:"",editBannerWeight:"",editBannerCollege:"西南交通大学",editBannerSpecial:"",editBannerMini:"",editBannerLink:"",editBannerPrice:"",editBannerBargainPrice:"",editBannerImage:""}},mounted:function(){var e=this;this.fullHeight=document.documentElement.clientHeight-this.$refs.headerView.offsetHeight-this.$refs.headSearchView.offsetHeight-220,window.onresize=function(){e.fullHeight=document.documentElement.clientHeight-e.$refs.headerView.offsetHeight-e.$refs.headSearchView.offsetHeight-220},localStorage.getItem("islogin")?this.getBannerList():this.common.loginOut(this)},methods:{getBannerList:function(){var e=this;this.loading=!0,this.common.requestDataParams("/vk/bannerlist","GET",{college:e.college,page:e.bannerCurrentPage,limit:e.bannerPageSize}).then(function(n){e.bannerList=n.data.data,e.bannerTotal=n.data.total,e.loading=!1}).catch(function(e){console.log(e)})},addBannerSure:function(){var e=this;if(this.checkAddBanner()){this.addBannerSureLoad=!0;var n=this.$refs.clearImageFile.files[0];this.common.requestDataFile("/vk/addbanner","POST",{title:e.bannerTitle,weight:e.bannerWeight,college:e.bannerCollege,special:e.bannerSpecial,mini:e.bannerMini,link:e.bannerLink,price:e.bannerPrice,bargain_price:e.bannerBargainPrice,image:n}).then(function(n){e.addBannerDialog=!1,e.addBannerSureLoad=!1,e.bannerTitle="",e.bannerWeight="",e.bannerCollege="西南交通大学",e.bannerSpecial=0,e.bannerMini="",e.bannerLink="",e.bannerPrice="",e.bannerBargainPrice="",e.bannerImage="",e.$refs.clearImageFile.value="",e.getBannerList()}).catch(function(e){console.log(e)})}},checkAddBanner:function(){var e=this.bannerTitle,n=this.bannerWeight,t=this.bannerLink,a=this.bannerPrice,i=this.bannerBargainPrice,l=this.$refs.clearImageFile.value;return""===e||null===e||void 0===e?(this.$message.error("标题不能为空"),!1):""===n||null===n||void 0===n?(this.$message.error("权重不能为空"),!1):""===t||null===t||void 0===t?(this.$message.error("链接不能为空"),!1):""===a||null===a||void 0===a?(this.$message.error("正价不能为空"),!1):""===i||null===i||void 0===i?(this.$message.error("折扣价不能为空"),!1):""!==l&&null!==l&&void 0!==l||(this.$message.error("图片不能为空"),!1)},selectImage:function(e){var n=e.target.files[0];n?this.bannerImage=window.URL.createObjectURL(n):(this.$refs.clearImageFile.value="",this.bannerImage="")},editBanner:function(e){this.editBannerDialog=!0,this.editBannerId=e.id,this.editBannerTitle=e.title,this.editBannerWeight=e.weight,this.editBannerCollege="西南交通大学",this.editBannerSpecial=e.special,this.editBannerMini=e.mini,this.editBannerLink=e.link,this.editBannerPrice=e.price,this.editBannerBargainPrice=e.bargain_price,this.editBannerImage=e.image},editBannerSure:function(){var e=this,n=this;if(this.checkEditBanner()){this.editBannerSureLoad=!0;var t=this.$refs.clearImageFile1.files[0];this.common.requestDataFile("/vk/updatebanners","POST",{id:n.editBannerId,title:n.editBannerTitle,weight:n.editBannerWeight,college:n.editBannerCollege,special:n.editBannerSpecial,mini:n.editBannerMini,link:n.editBannerLink,price:n.editBannerPrice,bargain_price:n.editBannerBargainPrice,image:t||"",status:1}).then(function(t){n.editBannerDialog=!1,n.editBannerSureLoad=!1,n.$refs.clearImageFile1.value="",e.getBannerList()}).catch(function(e){console.log(e)})}},checkEditBanner:function(){var e=this.editBannerTitle,n=this.editBannerWeight,t=this.editBannerLink,a=this.editBannerPrice,i=this.editBannerBargainPrice;return""===e||null===e||void 0===e?(this.$message.error("标题不能为空"),!1):""===n||null===n||void 0===n?(this.$message.error("权重不能为空"),!1):""===t||null===t||void 0===t?(this.$message.error("链接不能为空"),!1):""===a||null===a||void 0===a?(this.$message.error("正价不能为空"),!1):""!==i&&null!==i&&void 0!==i||(this.$message.error("折扣价不能为空"),!1)},selectImage1:function(e){var n=e.target.files[0];n?this.editBannerImage=window.URL.createObjectURL(n):(this.$refs.clearImageFile1.value="",this.editBannerImage="")},deleteBanner:function(e){var n=this;this.$confirm("是否删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.common.requestDataFile("/vk/updatebanners","POST",{id:e.id,status:0}).then(function(e){n.$message.success("删除成功"),n.getBannerList()}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},bannerCurrentChange:function(e){this.bannerCurrentPage=e,this.getBannerList()},refresh:function(){this.getBannerList()}}},i={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"banner"},[t("div",{ref:"headerView"},[t("el-row",[t("el-col",{attrs:{span:24}},[e._v("\n                banner列表\n                "),t("div",{staticClass:"el-header-right"},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){e.addBannerDialog=!0}}},[e._v("新增banner")]),e._v(" "),t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-refresh"},on:{click:function(n){return e.refresh()}}})],1)])],1)],1),e._v(" "),t("div",{ref:"headSearchView"},[t("el-row",{staticClass:"el-top"},[t("el-col",{attrs:{span:24}},[t("el-select",{attrs:{size:"small",placeholder:"学校"},model:{value:e.college,callback:function(n){e.college=n},expression:"college"}},e._l(e.collegeList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:function(n){return e.refresh()}}},[e._v("查询")])],1)],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"el-top",attrs:{data:e.bannerList,height:e.fullHeight||null,size:"small"}},[t("el-table-column",{attrs:{prop:"title",label:"标题"}}),e._v(" "),t("el-table-column",{attrs:{prop:"weight",label:"权重"}}),e._v(" "),t("el-table-column",{attrs:{label:"今日特价显示",width:"100"},scopedSlots:e._u([{key:"default",fn:function(n){return[0===n.row.special?t("div",{staticClass:"red-text"},[e._v("否")]):t("div",{staticClass:"green-text"},[e._v("是")])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"mini",label:"小程序ID"}}),e._v(" "),t("el-table-column",{attrs:{prop:"link",label:"链接"}}),e._v(" "),t("el-table-column",{attrs:{label:"图片",width:"200"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("img",{staticClass:"banner-img",attrs:{src:e.row.image}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"college",label:"大学"}}),e._v(" "),t("el-table-column",{attrs:{prop:"price",label:"正价"}}),e._v(" "),t("el-table-column",{attrs:{prop:"bargain_price",label:"折扣价"}}),e._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.editBanner(n.row)}}},[e._v("编辑")]),e._v(" "),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteBanner(n.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),t("el-row",[t("el-col",{staticClass:"page-block",attrs:{md:24}},[t("el-pagination",{attrs:{background:!0,"page-size":e.bannerPageSize,total:e.bannerTotal,"current-page":e.bannerCurrentPage,layout:"total, prev, pager, next, jumper"},on:{"current-change":e.bannerCurrentChange}})],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"新增banner",visible:e.addBannerDialog,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(n){e.addBannerDialog=n}}},[t("el-form",{nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"标题 *",size:"medium","label-width":"100px"}},[t("el-input",{model:{value:e.bannerTitle,callback:function(n){e.bannerTitle=n},expression:"bannerTitle"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"权重 *",size:"medium","label-width":"100px"}},[t("el-input",{attrs:{type:"number",placeholder:"数值越大，在首页显示越靠前"},model:{value:e.bannerWeight,callback:function(n){e.bannerWeight=n},expression:"bannerWeight"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"学校",size:"medium","label-width":"100px"}},[t("el-select",{attrs:{size:"medium"},model:{value:e.bannerCollege,callback:function(n){e.bannerCollege=n},expression:"bannerCollege"}},e._l(e.collegeList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"今日特价显示",size:"medium","label-width":"100px"}},[t("el-select",{attrs:{size:"medium"},model:{value:e.bannerSpecial,callback:function(n){e.bannerSpecial=n},expression:"bannerSpecial"}},e._l(e.specialList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"小程序ID",size:"medium","label-width":"100px"}},[t("el-input",{attrs:{placeholder:"公众号链接可不填"},model:{value:e.bannerMini,callback:function(n){e.bannerMini=n},expression:"bannerMini"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"链接 *",size:"medium","label-width":"100px"}},[t("el-input",{model:{value:e.bannerLink,callback:function(n){e.bannerLink=n},expression:"bannerLink"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"正价 *",size:"medium","label-width":"100px"}},[t("el-input",{attrs:{type:"number"},model:{value:e.bannerPrice,callback:function(n){e.bannerPrice=n},expression:"bannerPrice"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"折扣价 *",size:"medium","label-width":"100px"}},[t("el-input",{attrs:{type:"number"},model:{value:e.bannerBargainPrice,callback:function(n){e.bannerBargainPrice=n},expression:"bannerBargainPrice"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"图片 *",size:"medium","label-width":"100px"}},[t("div",{staticClass:"file-creation"},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择banner图片")]),e._v(" "),t("input",{ref:"clearImageFile",attrs:{type:"file",accept:"image/*"},on:{change:function(n){return e.selectImage(n)}}})],1),e._v(" "),t("div",{staticClass:"el-top"},[t("img",{staticClass:"file-image",attrs:{src:e.bannerImage}})])])],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(n){e.addBannerDialog=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary",loading:e.addBannerSureLoad},on:{click:function(n){return e.addBannerSure()}}},[e._v("确 定")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"编辑banner",visible:e.editBannerDialog,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(n){e.editBannerDialog=n}}},[t("el-form",{nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"标题 *",size:"medium","label-width":"100px"}},[t("el-input",{model:{value:e.editBannerTitle,callback:function(n){e.editBannerTitle=n},expression:"editBannerTitle"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"权重 *",size:"medium","label-width":"100px"}},[t("el-input",{attrs:{type:"number",placeholder:"数值越大，在首页显示越靠前"},model:{value:e.editBannerWeight,callback:function(n){e.editBannerWeight=n},expression:"editBannerWeight"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"学校",size:"medium","label-width":"100px"}},[t("el-select",{attrs:{size:"medium"},model:{value:e.editBannerCollege,callback:function(n){e.editBannerCollege=n},expression:"editBannerCollege"}},e._l(e.collegeList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"今日特价显示",size:"medium","label-width":"100px"}},[t("el-select",{attrs:{size:"medium"},model:{value:e.editBannerSpecial,callback:function(n){e.editBannerSpecial=n},expression:"editBannerSpecial"}},e._l(e.specialList,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"小程序ID",size:"medium","label-width":"100px"}},[t("el-input",{attrs:{placeholder:"公众号链接可不填"},model:{value:e.editBannerMini,callback:function(n){e.editBannerMini=n},expression:"editBannerMini"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"链接 *",size:"medium","label-width":"100px"}},[t("el-input",{model:{value:e.editBannerLink,callback:function(n){e.editBannerLink=n},expression:"editBannerLink"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"正价 *",size:"medium","label-width":"100px"}},[t("el-input",{attrs:{type:"number"},model:{value:e.editBannerPrice,callback:function(n){e.editBannerPrice=n},expression:"editBannerPrice"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"折扣价 *",size:"medium","label-width":"100px"}},[t("el-input",{attrs:{type:"number"},model:{value:e.editBannerBargainPrice,callback:function(n){e.editBannerBargainPrice=n},expression:"editBannerBargainPrice"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"图片 *",size:"medium","label-width":"100px"}},[t("div",{staticClass:"file-creation"},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择banner图片")]),e._v(" "),t("input",{ref:"clearImageFile1",attrs:{type:"file",accept:"image/*"},on:{change:function(n){return e.selectImage1(n)}}})],1),e._v(" "),t("div",{staticClass:"el-top"},[t("img",{staticClass:"file-image",attrs:{src:e.editBannerImage}})])])],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(n){e.editBannerDialog=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{size:"small",type:"primary",loading:e.editBannerSureLoad},on:{click:function(n){return e.editBannerSure()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var l=t("VU/8")(a,i,!1,function(e){t("q0jc")},"data-v-a2f754d0",null);n.default=l.exports},q0jc:function(e,n){}});
//# sourceMappingURL=2.484d6a0f6093193fa8a9.js.map